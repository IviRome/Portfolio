//------------------------------------------------------------------------------------------
// requires
//------------------------------------------------------------------------------------------
const express = require('express');
const app = express();
const parser = require('body-parser');
const path = require('path');

qr_codes = {
    "64abe4340118922887a3e7f271b7bd104bb3456eadfb68b65275e6338fea1cc": "rb_1",
    "32abe4344356722357a3d5f246b7bd104bb3456fjdpe68b65275e4738fea4df": "rb_2"
}


//------------------------------------------------------------------------------------------
//------------------------------------------------------------------------------------------
app.use(parser.urlencoded({ extended: true }));
app.use(parser.json()); //Auto parsea a objeto el body de los requests

//------------------------------------------------------------------------------------------
//------------------------------------------------------------------------------------------
app.get('/', function(req, res) {
        res.send({ "message": "Server Working" })
    })
    //------------------------------------------------------------------------------------------
    //------------------------------------------------------------------------------------------


//------------------------------------------------------------------------------------------
//------------------------------------------------------------------------------------------
app.get('/qr/:qr_code', (req, res) => {
        for (x in qr_codes) {
            if (req.params.qr_code == x) {
                res.send({ "robot_id": qr_codes[x] })
            }
        }
        res.status(404).send("Robot not found")

    })
    //------------------------------------------------------------------------------------------
    //------------------------------------------------------------------------------------------


//------------------------------------------------------------------------------------------
// puertos
//------------------------------------------------------------------------------------------
let PUERTO;
if (process.env.PORT === undefined) {
    PUERTO = 8080;
} else {
    PUERTO = process.env.PORT;
}

app.listen(PUERTO, function() {
    console.log('Server conectado en puerto ' + PUERTO);
});